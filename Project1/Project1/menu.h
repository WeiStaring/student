#pragma once
#include<iostream>
#include<cstring>
#include<string>
#include"RecordA.h"
#include"FileManage.h"
#include"error.h"
using namespace std;

void addStudentData()//menu选项1对应函数
{
	cout << "***************************************************" << endl;
	cout << "*" << "             ****研究生管理系统****              " << "*" << endl;
	cout << "*" << "                1.学术研究生信息录入             " << "*" << endl;
	cout << "*" << "                2.工程研究生信息录入             " << "*" << endl;
	cout << "***************************************************" << endl;
	int choice;
	while(1){
		Inputdata(choice, cin);
		if (choice == 1) {
			firstInputData(Graduate_a::aHead);
			saveStudentData(Graduate_a::aHead);
			break;
		}
		else if (choice == 2) {
			firstInputData(Graduate_e::eHead);
			saveStudentData(Graduate_e::eHead);
			break;
		}
		else {
			cout << "输入错误，请重新输入"<<endl;
		}
	}
}


void insertData() {	//menu选项2函数
	cout << "***************************************************" << endl;
	cout << "*" << "             ****研究生管理系统****              " << "*" << endl;
	cout << "*" << "                1.学术研究生信息插入             " << "*" << endl;
	cout << "*" << "                2.工程研究生信息插入             " << "*" << endl;
	cout << "***************************************************" << endl;
	int choice;
	
	while(1) {
		Inputdata(choice, cin);
		if (choice == 1) {
			Graduate_a* tmp = new Graduate_a();
			cout << "输入学术研究生信息" << endl;
			cin >> *tmp;
			tmp->pnext = Graduate_a::aHead->pnext;
			Graduate_a::aHead->pnext = tmp;
			saveStudentData(Graduate_a::aHead);
			break;
		}
		else if (choice == 2) {
			Graduate_e* tmp = new Graduate_e();
			cout << "输入工程研究生信息" << endl;
			cin >> *tmp;
			tmp->pnext = Graduate_e::eHead->pnext;
			Graduate_e::eHead->pnext = tmp;
			saveStudentData(Graduate_e::eHead);
			break;
		}
		else {
			cout << "输入错误，请重新输入" << endl;
		}
	}
}


void delData() {//menu选项3函数
	cout << "***************************************************" << endl;
	cout << "*" << "             ****研究生管理系统****              " << "*" << endl;
	cout << "*" << "                1.学术研究生信息删除             " << "*" << endl;
	cout << "*" << "                2.工程研究生信息删除             " << "*" << endl;
	cout << "***************************************************" << endl;
	int choice;
	while (1) {
		Inputdata(choice, cin);
		if (choice == 1) {
			delAcademicData(Graduate_a::aHead, Graduate_a::del_aHead);
			break;
		}
		else if (choice == 2) {
			//待写
			break;
		}
		else {
			cout << "输入错误，请重新输入" << endl;
		}
	}
}


void printData() {//menu选项4函数
	cout << "***************************************************" << endl;
	cout << "*" << "             ****研究生管理系统****              " << "*" << endl;
	cout << "*" << "                1.学术研究生信息显示             " << "*" << endl;
	cout << "*" << "                2.工程研究生信息显示             " << "*" << endl;
	cout << "*" << "                3.所有研究生信息显示             " << "*" << endl;
	cout << "***************************************************" << endl;

	int choice;
	while (1) {
		Inputdata(choice, cin);
		if (choice == 1)
		{
			cout << "学术研究生信息如下" << endl;
			Graduate_a* tmp = Graduate_a::aHead->pnext;
			if (!tmp)
				cout << "学术研究生信息为空，请先录入" << endl;
			else
			{
				while (tmp)
				{
					cout << *tmp << endl;
					tmp = tmp->pnext;
				}
			}
			cout << "学术研究生信息输出完毕" << endl;
			break;
		}
		else if (choice == 2)
		{
			cout << "工程研究生信息如下" << endl;
			Graduate_e* tmp2 = Graduate_e::eHead->pnext;
			if (!tmp2)
				cout << "工程研究生信息为空，请先录入" << endl;
			else
			{
				while (tmp2)
				{
					cout << *tmp2 << endl;
					tmp2 = tmp2->pnext;
				}
			}
			cout << "工程研究生信息输出完毕" << endl;
			break;
		}
		else if(choice == 3)
		{
			cout << "学术研究生信息如下" << endl;
			Graduate_a* tmp = Graduate_a::aHead->pnext;
			if (!tmp)
				cout << "学术研究生信息为空，请先录入" << endl;
			else
			{
				while (tmp)
				{
					cout << *tmp << endl;
					tmp = tmp->pnext;
				}
			}
			cout << "学术研究生信息输出完毕" << endl;

			cout << "工程研究生信息如下" << endl;
			Graduate_e* tmp2 = Graduate_e::eHead->pnext;
			if (!tmp2)
				cout << "工程研究生信息为空，请先录入" << endl;
			else
			{
				while (tmp2)
				{
					cout << *tmp2 << endl;
					tmp2 = tmp2->pnext;
				}
			}
			cout << "工程研究生信息输出完毕" << endl;
			break;
		}
		else {
			cout << "输入错误，请重新输入" << endl;
		}
	}
}


void modifyData() {
	cout << "***************************************************" << endl;
	cout << "*" << "             ****研究生管理系统****              " << "*" << endl;
	cout << "*" << "                1.学术研究生信息修改             " << "*" << endl;
	cout << "*" << "                2.工程研究生信息修改             " << "*" << endl;
	cout << "***************************************************" << endl;
	int choice;
	
	while (1) {
		Inputdata(choice, cin);
		if (choice == 1)
		{
			Graduate_a* tmp = seekAcademicData(Graduate_a::aHead);
			cout << "请对该学生的信息进行修改!" << endl;
			cin >> *tmp;
			cout << "修改成功" << endl;
			break;
		}
		else if(choice==2)
		{
			Graduate_e* tmp = seekEngineerData(Graduate_e::eHead);
			cout << "请对该学生的信息进行修改!" << endl;
			cin >> *tmp;
			cout << "修改成功" << endl;
			break;
		}
		else {
			cout << "输入错误，请重新输入" << endl;
		}
	}
}


void seekGraduateStudent() {
	cout << "***************************************************" << endl;
	cout << "*" << "             ****研究生管理系统****              " << "*" << endl;
	cout << "*" << "                1.学术研究生信息查找             " << "*" << endl;
	cout << "*" << "                2.工程研究生信息查找             " << "*" << endl;
	cout << "***************************************************" << endl;
	int choice;
	cin >> choice;
	//暂时没写if else
	Graduate_a *p;
	if (choice) {
		p = seekAcademicData(Graduate_a::aHead);
		if (p)
			cout << *p;
	}
		
}

void statisticalStudentData() {
	//Graduate_a::aHead->Bsort(Graduate_a::aHead, 1);
}

void initSystem() {
	cout << "***************************************************" << endl;
	cout << "*" << "             ****研究生管理系统****              " << "*" << endl;
	cout << "*" << "            该操作将会删除所有学生信息             " << "*" << endl;
	cout << "*" << "          并重置系统，是否仍要进行？(y/n)             " << "*" << endl;
	cout << "***************************************************" << endl;

	char c;
	cin >> c;

	if (c =='y')
	{
		Graduate_a * tmp1 = new Graduate_a();
		Graduate_e * tmp2 = new Graduate_e();
		saveStudentData(tmp1);
		saveStudentData(tmp2);
		cout << "已成功重置系统" << endl;
	}
	else
		return;

}

void exitSystem() {
	/*
	cout << "从文件读入信息" << endl;
	Graduate_a* tmp = getAcademicStudentData(Graduate_a::aHead);
	cout << *(tmp->pnext) << endl;*/
	system("pause");
	exit(0);
};

void menu()//菜单界面
{
	loadEngineerStudentData(Graduate_e::eHead);
	loadAcademicStudentData(Graduate_a::aHead);

	while (1) {
		int i;
		cout << "***************************************************" << endl;
		cout << "*" << "             ****研究生管理系统****              " << "*" << endl;
		cout << "*" << "                1.研究生信息录入*                " << "*" << endl;
		cout << "*" << "                2.研究生信息插入                 " << "*" << endl;
		cout << "*" << "                3.研究生信息删除                 " << "*" << endl;
		cout << "*" << "                4.研究生信息输出                 " << "*" << endl;
		cout << "*" << "                5.研究生信息修改                 " << "*" << endl;
		cout << "*" << "                6.研究生信息查找                 " << "*" << endl;
		cout << "*" << "                7.研究生信息统计                 " << "*" << endl;
		cout << "*" << "                8.退出系统                       " << "*" << endl;
		cout << "*" << "                9.初始化该系统                   " << "*" << endl;
		cout << "****************************************************" << endl;

		cout << "请选择:" << endl;
		Inputdata(i, cin);
		switch (i) {
		case 1:
			addStudentData();//信息录入
			cout << "录入成功！" << endl;
			system("pause");
			system("cls");
			break;
		case 2:
			insertData();//信息插入
			cout << "插入成功！" << endl;
			system("pause");
			system("cls");
			break;
		case 3:
			delData();//信息删除
			cout << "删除成功！" << endl;
			system("pause");
			system("cls");
			break;
		case 4:
			printData();//信息输出
			cout << "输出成功！" << endl;
			system("pause");
			system("cls");
			break;
		case 5:
			modifyData();//信息修改
			cout << "修改成功！" << endl;
			system("pause");
			system("cls");
			break;
		case 6:
			seekGraduateStudent();//信息查找
			cout << "查找成功！" << endl;
			system("pause");
			system("cls");
			break;
		case 7:
			statisticalStudentData();//信息统计
			system("pause");
			system("cls");
			break;
		case 8:
			exitSystem();//系统退出函数
			break;
		case 9:
			initSystem();//初始化系统
			break;
		default:
			cout << "输入有误，请重新输入！" << endl;
			break;
		}
	}
}


void welcome()//欢迎界面
{
	cout << "************************************" << endl;
	cout << "*****         欢迎使用         *****" << endl << endl;
	cout << "****     研究生成绩管理系统     ****" << endl << endl;;
	cout << "* 作者：信息科学与工程学院计科1705 *" << endl << endl;;
	cout << "****   出品日期：2018年1月15日  ****" << endl;
	cout << "************************************" << endl;
	//密码操作
	int i = 0;
	string user;
	string key;
	while (1) {
		cout << "请输入用户名：" << endl;
		cin >> user;
		cout << "请输入口令：" << endl;
		cin >> key;
		if (!(user == "admin" && key == "admin"))
		{
			i++;
			if (i >= 3)
			{
				cout << "您已超过输入次数，系统将自动退出！" << endl;
				system("pause");
				exit(0);
			}
			cout << "账户或密码输入有误！请重新输入" << endl;
		}
		else
		{
			cout << "恭喜！输入正确！" << endl;
			system("pause");
			system("cls");
			break;
		}
	}
}
